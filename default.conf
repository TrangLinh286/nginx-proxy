server {
    listen 80;
    server_name tranglinh.onrender.com;

    # Chuyển hướng HTTP sang HTTPS nếu cần
    location / {
        return 301 https://$host$request_uri;
    }
}

server {
    listen 443 ssl;
    server_name tranglinh.onrender.com;

    # Chứng chỉ SSL (cần thay thế bằng đường dẫn tới file chứng chỉ của bạn)
    ssl_certificate /path/to/your/certificate.crt;  # Thay bằng đường dẫn đến chứng chỉ SSL của bạn
    ssl_certificate_key /path/to/your/private.key;  # Thay bằng đường dẫn đến khóa riêng của bạn

    # Cấu hình các tham số SSL
    ssl_protocols       TLSv1.2 TLSv1.3;  # Chỉ định các giao thức SSL an toàn
    ssl_ciphers         HIGH:!aNULL:!MD5;  # Cấu hình các cipher an toàn
    ssl_prefer_server_ciphers on;

    location / {
        resolver 8.8.8.8;  # Sử dụng DNS Google để giải quyết hostname
        proxy_pass https://embed.tawk.to/;  # Đảm bảo có dấu "/" ở cuối
        proxy_set_header Host embed.tawk.to;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # Thêm cấu hình cho SSL
        proxy_ssl_server_name on;
        
        # Thêm các header CORS nếu cần
        add_header 'Access-Control-Allow-Origin' '*';
        add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
        add_header 'Access-Control-Allow-Headers' 'Origin, X-Requested-With, Content-Type, Accept';
    }
}
